<mxfile host="app.diagrams.net" modified="2021-07-04T10:20:45.768Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36" etag="-uvEhHHvwNHG7PZrcexT" version="14.8.3" type="github" pages="2">
  <diagram name="Page-1" id="822b0af5-4adb-64df-f703-e8dfc1f81529">
    <mxGraphModel dx="593" dy="313" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="1100" pageHeight="850" background="none" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="KSW5xv-IBpdEUwikCmXP-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=18;entryX=0.5;entryY=0;entryDx=0;entryDy=0;shadow=1;" parent="1" source="KSW5xv-IBpdEUwikCmXP-1" target="KSW5xv-IBpdEUwikCmXP-12" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="480" y="230" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KSW5xv-IBpdEUwikCmXP-1" value="&lt;font style=&quot;font-size: 24px&quot;&gt;ping.php&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=18;fillColor=#e1d5e7;strokeColor=#9673a6;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="400" y="160" width="140" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KSW5xv-IBpdEUwikCmXP-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=18;shadow=1;" parent="1" source="KSW5xv-IBpdEUwikCmXP-12" target="KSW5xv-IBpdEUwikCmXP-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KSW5xv-IBpdEUwikCmXP-12" value="&lt;font style=&quot;font-size: 18px&quot;&gt;$target = $_POST[ &#39;target&#39; ];&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=18;fillColor=#ffe6cc;strokeColor=#d79b00;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="350" y="240" width="240" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KSW5xv-IBpdEUwikCmXP-19" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=18;shadow=1;" parent="1" source="KSW5xv-IBpdEUwikCmXP-13" target="KSW5xv-IBpdEUwikCmXP-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KSW5xv-IBpdEUwikCmXP-13" value="&lt;font style=&quot;font-size: 24px&quot;&gt;$cmd&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=18;fillColor=#fff2cc;strokeColor=#d6b656;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="400" y="320" width="140" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KSW5xv-IBpdEUwikCmXP-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=18;shadow=1;" parent="1" source="KSW5xv-IBpdEUwikCmXP-15" target="KSW5xv-IBpdEUwikCmXP-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KSW5xv-IBpdEUwikCmXP-15" value="&lt;font style=&quot;font-size: 18px&quot;&gt;搜索命令执行函数&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontSize=18;fillColor=#d5e8d4;strokeColor=#82b366;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="385" y="80" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KSW5xv-IBpdEUwikCmXP-18" value="$res = shell_exec( $cmd );" style="whiteSpace=wrap;html=1;rounded=0;fontSize=18;strokeColor=#b85450;fillColor=#f8cecc;shadow=1;" parent="1" vertex="1">
          <mxGeometry x="325" y="410" width="290" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8JKxnC0FZ5SrZLU6QjSB-5" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontStyle=0" edge="1" parent="1" source="8JKxnC0FZ5SrZLU6QjSB-1" target="8JKxnC0FZ5SrZLU6QjSB-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8JKxnC0FZ5SrZLU6QjSB-7" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontStyle=0" edge="1" parent="1" source="8JKxnC0FZ5SrZLU6QjSB-1" target="8JKxnC0FZ5SrZLU6QjSB-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8JKxnC0FZ5SrZLU6QjSB-9" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontStyle=0" edge="1" parent="1" source="8JKxnC0FZ5SrZLU6QjSB-1" target="8JKxnC0FZ5SrZLU6QjSB-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8JKxnC0FZ5SrZLU6QjSB-11" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontStyle=0" edge="1" parent="1" source="8JKxnC0FZ5SrZLU6QjSB-1" target="8JKxnC0FZ5SrZLU6QjSB-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8JKxnC0FZ5SrZLU6QjSB-1" value="不足" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="960" y="188" width="52" height="52" as="geometry" />
        </mxCell>
        <mxCell id="8JKxnC0FZ5SrZLU6QjSB-4" value="多线程支持欠佳" style="whiteSpace=wrap;html=1;shadow=1;fontStyle=0;strokeColor=#b46504;fillColor=#fad7ac;" vertex="1" parent="1">
          <mxGeometry x="1058" y="195" width="120" height="38" as="geometry" />
        </mxCell>
        <mxCell id="8JKxnC0FZ5SrZLU6QjSB-6" value="独特的语法" style="whiteSpace=wrap;html=1;shadow=1;fontStyle=0;strokeColor=#0e8088;fillColor=#b0e3e6;" vertex="1" parent="1">
          <mxGeometry x="926" y="279" width="120" height="34" as="geometry" />
        </mxCell>
        <mxCell id="8JKxnC0FZ5SrZLU6QjSB-8" value="商业支持" style="whiteSpace=wrap;html=1;shadow=1;fontStyle=0;strokeColor=#56517e;fillColor=#d0cee2;" vertex="1" parent="1">
          <mxGeometry x="798" y="198" width="120" height="32" as="geometry" />
        </mxCell>
        <mxCell id="8JKxnC0FZ5SrZLU6QjSB-10" value="运行效率略低" style="whiteSpace=wrap;html=1;shadow=1;fontStyle=0;strokeColor=#ae4132;fillColor=#fad9d5;" vertex="1" parent="1">
          <mxGeometry x="926" y="116" width="120" height="33" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="Jhy2rpe0djcWzxP1dWyO" name="Page-2">
    <mxGraphModel dx="593" dy="732" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-0" />
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-1" parent="GZ0pMTBwfV9K0P_AXOUc-0" />
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-6" value="漏洞：不管是否存在，都会执行后面的代码" style="whiteSpace=wrap;html=1;rounded=1;shadow=1;strokeColor=#6c8ebf;fillColor=#dae8fc;glass=0;" vertex="1" parent="GZ0pMTBwfV9K0P_AXOUc-1">
          <mxGeometry x="340" y="62" width="235" height="60" as="geometry" />
        </mxCell>
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" edge="1" parent="GZ0pMTBwfV9K0P_AXOUc-1" source="GZ0pMTBwfV9K0P_AXOUc-8" target="GZ0pMTBwfV9K0P_AXOUc-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="GZ0pMTBwfV9K0P_AXOUc-1" source="GZ0pMTBwfV9K0P_AXOUc-8" target="GZ0pMTBwfV9K0P_AXOUc-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-8" value="&lt;span&gt;判断install.lock是否存在&lt;/span&gt;" style="rhombus;whiteSpace=wrap;html=1;rounded=1;shadow=1;glass=0;strokeColor=#6c8ebf;fillColor=#dae8fc;" vertex="1" parent="GZ0pMTBwfV9K0P_AXOUc-1">
          <mxGeometry x="219" y="52" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="GZ0pMTBwfV9K0P_AXOUc-1" source="GZ0pMTBwfV9K0P_AXOUc-10" target="GZ0pMTBwfV9K0P_AXOUc-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-10" value="开始" style="rounded=0;whiteSpace=wrap;html=1;shadow=1;glass=0;strokeColor=#82b366;fillColor=#d5e8d4;" vertex="1" parent="GZ0pMTBwfV9K0P_AXOUc-1">
          <mxGeometry x="220" y="-20" width="78" height="39" as="geometry" />
        </mxCell>
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="GZ0pMTBwfV9K0P_AXOUc-1" source="GZ0pMTBwfV9K0P_AXOUc-11" target="GZ0pMTBwfV9K0P_AXOUc-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-11" value="$dbname = $_POST[&quot;dbname&quot;];" style="rounded=0;whiteSpace=wrap;html=1;shadow=1;glass=0;strokeColor=#d79b00;fillColor=#ffe6cc;" vertex="1" parent="GZ0pMTBwfV9K0P_AXOUc-1">
          <mxGeometry x="169.83" y="163" width="178.34" height="43" as="geometry" />
        </mxCell>
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-15" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;fillColor=#fff2cc;strokeColor=#d6b656;" edge="1" parent="GZ0pMTBwfV9K0P_AXOUc-1" source="GZ0pMTBwfV9K0P_AXOUc-13" target="GZ0pMTBwfV9K0P_AXOUc-14">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="GZ0pMTBwfV9K0P_AXOUc-1" source="GZ0pMTBwfV9K0P_AXOUc-13" target="GZ0pMTBwfV9K0P_AXOUc-16">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-13" value="mysql_query" style="rounded=0;whiteSpace=wrap;html=1;shadow=1;glass=0;strokeColor=#d6b656;fillColor=#fff2cc;" vertex="1" parent="GZ0pMTBwfV9K0P_AXOUc-1">
          <mxGeometry x="197.92000000000002" y="239" width="122.17" height="43" as="geometry" />
        </mxCell>
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-14" value="error，则die 退出脚本" style="whiteSpace=wrap;html=1;rounded=0;shadow=1;strokeColor=#d6b656;fillColor=#fff2cc;glass=0;" vertex="1" parent="GZ0pMTBwfV9K0P_AXOUc-1">
          <mxGeometry x="406" y="239" width="151" height="42.5" as="geometry" />
        </mxCell>
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="GZ0pMTBwfV9K0P_AXOUc-1" source="GZ0pMTBwfV9K0P_AXOUc-16" target="GZ0pMTBwfV9K0P_AXOUc-17">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-16" value="$str_tmp" style="rounded=0;whiteSpace=wrap;html=1;shadow=1;glass=0;strokeColor=#9673a6;fillColor=#e1d5e7;" vertex="1" parent="GZ0pMTBwfV9K0P_AXOUc-1">
          <mxGeometry x="211.51" y="312" width="95" height="43" as="geometry" />
        </mxCell>
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-19" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;fillColor=#f8cecc;strokeColor=#b85450;" edge="1" parent="GZ0pMTBwfV9K0P_AXOUc-1" source="GZ0pMTBwfV9K0P_AXOUc-17" target="GZ0pMTBwfV9K0P_AXOUc-18">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-17" value="fwrite( $fp, $str_tmp );" style="rounded=0;whiteSpace=wrap;html=1;shadow=1;glass=0;strokeColor=#b85450;fillColor=#f8cecc;" vertex="1" parent="GZ0pMTBwfV9K0P_AXOUc-1">
          <mxGeometry x="194.01" y="385" width="130" height="60" as="geometry" />
        </mxCell>
        <mxCell id="GZ0pMTBwfV9K0P_AXOUc-18" value="sys/config.php" style="whiteSpace=wrap;html=1;rounded=0;shadow=1;strokeColor=#b85450;fillColor=#f8cecc;glass=0;" vertex="1" parent="GZ0pMTBwfV9K0P_AXOUc-1">
          <mxGeometry x="409.01" y="385" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="VQ3uUNAj_AzCOdlgiqrp-36" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="GZ0pMTBwfV9K0P_AXOUc-1" source="VQ3uUNAj_AzCOdlgiqrp-18" target="VQ3uUNAj_AzCOdlgiqrp-33">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VQ3uUNAj_AzCOdlgiqrp-18" value="查看网站逻辑结构" style="rounded=0;whiteSpace=wrap;html=1;shadow=1;glass=0;strokeColor=#82b366;fillColor=#d5e8d4;" vertex="1" parent="GZ0pMTBwfV9K0P_AXOUc-1">
          <mxGeometry x="989.5" y="42" width="143" height="32" as="geometry" />
        </mxCell>
        <mxCell id="VQ3uUNAj_AzCOdlgiqrp-39" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="GZ0pMTBwfV9K0P_AXOUc-1" source="VQ3uUNAj_AzCOdlgiqrp-33" target="VQ3uUNAj_AzCOdlgiqrp-40">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1061" y="193.7142682756696" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="VQ3uUNAj_AzCOdlgiqrp-33" value="查看配置文件" style="rounded=0;whiteSpace=wrap;html=1;shadow=1;glass=0;strokeColor=#d79b00;fillColor=#ffe6cc;" vertex="1" parent="GZ0pMTBwfV9K0P_AXOUc-1">
          <mxGeometry x="994" y="107" width="134" height="34" as="geometry" />
        </mxCell>
        <mxCell id="VQ3uUNAj_AzCOdlgiqrp-44" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="GZ0pMTBwfV9K0P_AXOUc-1" source="VQ3uUNAj_AzCOdlgiqrp-40" target="VQ3uUNAj_AzCOdlgiqrp-43">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="VQ3uUNAj_AzCOdlgiqrp-40" value="审计入口文件" style="rounded=0;whiteSpace=wrap;html=1;shadow=1;glass=0;strokeColor=#b85450;fillColor=#f8cecc;" vertex="1" parent="GZ0pMTBwfV9K0P_AXOUc-1">
          <mxGeometry x="998.5" y="171" width="125" height="35" as="geometry" />
        </mxCell>
        <mxCell id="VQ3uUNAj_AzCOdlgiqrp-43" value="审计关键代码" style="rounded=0;whiteSpace=wrap;html=1;shadow=1;glass=0;strokeColor=#9673a6;fillColor=#e1d5e7;" vertex="1" parent="GZ0pMTBwfV9K0P_AXOUc-1">
          <mxGeometry x="1003" y="239" width="116" height="31" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
